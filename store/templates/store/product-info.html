{% extends "./base.html" %}

{% load static %}


{% block content %}


<!-- Breadcrumb -->
  <nav class="breadcrumb">
    <a href="/">Trang chủ</a>
    <span>›</span>
    {% if product.category %}
      <a href="{{ product.category.get_absolute_url }}">{{ product.category.name }}</a>
      <span>›</span>
    {% endif %}
    <span class="current">{{ product.title }}</span>
  </nav>

  <!-- PRODUCT DETAIL -->
  <main class="product-detail" id="product-detail">
    <!-- LEFT: Gallery -->
    <section class="pd-gallery">
      <div class="pd-main-img">
        {% if product.image %}
          <img src="{{ product.image.url }}" alt="{{ product.title }}" id="pd-main-img">
        {% else %}
          <img src="/static/media/images/placeholder.png" alt="{{ product.title }}" id="pd-main-img">
        {% endif %}
      </div>

      {% if product.image %}
      <div class="pd-thumbs" id="pd-thumbs">
        <button class="thumb is-active" type="button">
          <img src="{{ product.image.url }}" data-large="{{ product.image.url }}" alt="{{ product.title }}">
        </button>
      </div>
      {% endif %}

    </section>

    <!-- RIGHT: Info -->
    <section class="pd-info">
  <h1 class="pd-title">{{ product.title }}</h1>

      <div class="pd-row">
        <div class="pd-label">Màu sắc:</div>
        <div class="pd-colors">
          {% if product.colors %}
            {% for c in product.colors %}
              <label class="color-chip">
                <input type="radio" name="color" {% if forloop.first %}checked{% endif %}>
                <span class="dot" style="--c:{{ c.hex|default:'#ccc' }}"></span>
                <span class="color-name">{{ c.name }}</span>
              </label>
            {% endfor %}
          {% endif %}
        </div>
      </div>

      <div class="pd-price">
        <div class="price">{% if product.price %}{{ product.price }}{% endif %}</div>
        <div class="price-note">{% if product.price %}(Giá đã bao gồm VAT){% endif %}</div>
      </div>

      

      <div class="col">
              
                        <div class="row p-3">
              
                            <div class="col-6">
              
                               
                                <label for="select">Số lượng</label>
                                
                                &nbsp; 
                               
                                <select id="select">
              
                                    <option value="1">1</option>
              
                                    <option value="2">2</option>
              
                                    <option value="3">3</option>
              
                                    <option value="4">4</option>
              
                                </select>

                            </div>

                            <div class="col-6 text-end">
                                
                                <button type="button" id="add-button" value="{{product.id}}" class="btn btn-secondary btn-sm">
                        
                                    <i class="fa fa-plus" aria-hidden="true"></i> &nbsp; Thêm vào giỏ hàng 
                            
                                </button> 
                            

                            </div>
                        
                        </div>

                    </div>

      
    </section>
  </main>

  <!-- Tabs: Thông tin / Thông số -->
  <section class="pd-tabs" id="pd-tabs" data-product-id="flip7">
    <input type="radio" id="tab-info" name="pdtab" checked>
    <label class="pd-tab" for="tab-info" aria-controls="panel-info">Thông tin sản phẩm</label>

    <input type="radio" id="tab-specs" name="pdtab">
    <label class="pd-tab" for="tab-specs" aria-controls="panel-specs">Thông số kỹ thuật</label>

    <div class="pd-panels">
      <div id="panel-info" class="pd-panel">
        <div class="pd-desc">
          {% if product.description %}
            <p>{{ product.description }}</p>
          {% endif %}
        </div>
      </div>
      <div id="panel-specs" class="pd-panel">
        {% if product.pin or product.ram or product.screen_size %}
          <ul class="specs">
            {% if product.pin %}
              <li><span class="k">Pin</span><span class="v">{{ product.pin }}</span></li>
            {% endif %}
            {% if product.ram %}
              <li><span class="k">RAM</span><span class="v">{{ product.ram }}</span></li>
            {% endif %}
            {% if product.screen_size %}
              <li><span class="k">Màn hình</span><span class="v">{{ product.screen_size }}</span></li>
            {% endif %}
          </ul>
        {% endif %}
      </div>
    </div>
  </section>

  <script>

    // Add button

    $(document).on('click', '#add-button', function(e){

        e.preventDefault();

        $.ajax({

            type: 'POST',
            url: '{% url "cart-add" %}',
            data: {

                product_id: $('#add-button').val(),
                product_quantity: $('#select option:selected').text(),
                csrfmiddlewaretoken: "{{csrf_token}}",
                action: 'post'

            },

            success: function(json){

                //console.log(json)

                document.getElementById("cart-qty").textContent = json.qty


            },

            error: function(xhr, errmsg, err){


            }

        });


    })




</script>


  {% endblock %}    